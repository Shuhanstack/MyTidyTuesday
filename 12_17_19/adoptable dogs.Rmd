---
title: "adoptable dogs"
author: "Shuhan Song"
date: "12/16/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r}
library(tidyverse)
library(janitor)
library(sf)
```


```{r}
# Get the Data

dog_moves <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_moves.csv')

dog_travel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_travel.csv') 

dog_descriptions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-12-17/dog_descriptions.csv')

```


```{r}
state_loc <- data.frame("state" = state.name,
                        "long" = state.center$x,
                        "lat" = state.center$y) %>% 
  filter(state != "Alaska") %>% 
  filter(state != "Hawaii")

dog_moves_us <- dog_moves %>% 
  filter(inUS == TRUE) %>% 
  rename(state = location) %>% 
  left_join(state_loc, by = "state") %>% 
  drop_na(long, lat)

dog_moves_us <- st_as_sf(dog_moves_us, coords = c('long', 'lat'))

st_crs(dog_moves_us) <- 4326


states_polygon <- map_data("state")

myPalette <- colorRampPalette(c("cyan", "#007FFF", "yellow", "#FFBF00", "orange"))

ggplot() +
  geom_polygon(data = states_polygon,
               mapping = aes(x = long, y = lat,
                             group = group),
               fill = "black",
               color = "gray",
               size = 0.3) +
  geom_sf(data = dog_moves_us,
          aes(color = total),
          size = 3,
          alpha = 0.6) +
  scale_color_gradientn(colors = myPalette(3)) +
  theme_void() +
  labs(color = "Total number of \nadoptable dogs")
  
```

